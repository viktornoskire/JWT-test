<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>JWT Login</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
</head>
<body>
    <input name="username">
    <input name="password">
    <button onclick="run()">Run</button>
    <script>
        async function run() {
            const username = document.querySelector("input[name=username]");
            const password = document.querySelector("input[name=password]");
            const credentials = `${username}:${password}`;
            const b64credentials = btoa(credentials);

            console.log(b64credentials);

            const loginRes = await fetch("/api/login", {
                method: "POST",
                headers: {
                    "Authorization": "Basic" + b64credentials,
                },
            });
            const loginPayload = await loginRes.json();

            const res = await fetch("/api/protected", {
                headers: {
                    "Authorization": "Bearer" + loginPayload.token,
                },
            });
            const payload = await res.json();
            console.log(payload);
        }
    </script>
</body>
</html>